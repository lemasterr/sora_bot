# sora_bot

Инструменты для автоматизации сценариев Sora Suite: автогенерация контента,
загрузка и обработка материалов. Приложение включает десктопный интерфейс на
PyQt6 и набор воркеров, которые запускаются напрямую из GUI.

## Установка зависимостей

```bash
python -m venv .venv
source .venv/bin/activate  # или .venv\Scripts\activate в Windows
python -m pip install --upgrade pip
python -m pip install -r sora_suite/requirements.txt
```

> **Важно:** для генерации изображений используется библиотека
> `google-genai==1.45.0`. Эта версия доступна для Python 3.9+ и корректно
> устанавливается на macOS, Linux и Windows.

## Настройка Google AI Studio

1. Получите API-ключ в [Google AI Studio](https://aistudio.google.com/).
2. Запустите Sora Suite и откройте вкладку **Настройки → Генерация картинок**.
3. В блоке «Google AI Studio — генерация изображений» включите опцию и заполните:
   - API-ключ;
   - модель (`models/imagen-4.0-generate-001` по умолчанию);
   - параметры генерации (соотношение сторон, размер, MIME-тип, число картинок,
     лимит запросов и директорию для сохранения).
4. Уточните, нужно ли прикреплять сгенерированные изображения к заявке в Sora —
   для этого предусмотрен чекбокс «Прикреплять сгенерированные изображения к
   заявке в Sora».
5. Сохраните настройки — они автоматически попадут в окружение воркера
   `workers/autogen/main.py`.

Промпты можно описывать как обычным текстом по строкам, так и в JSON-формате,
передавая поля `prompt`, `image_prompts`, `attachments` и `number_of_images`.
Чтобы привязать текстовую заявку к конкретному изображению, используйте поле
`video_prompt` (доступно как в `prompts.txt`, так и в `image_prompts.txt`). Если
чекбокс прикрепления выключен, изображения всё равно сохраняются в
`generated_images/`, но не подгружаются к заявке.

## Кнопки автогена

На вкладке «Промпы» доступны два варианта запуска:

- **«Сохранить и запустить автоген (видео)»** — классический сценарий отправки
  промптов в Sora без обязательной генерации изображений (используется, например,
  для видео-генерации).
- **«Сохранить и запустить автоген (картинки)»** — форсирует использование Google
  AI Studio. Перед запуском приложение проверяет наличие API-ключа и, при успехе,
  запускает воркер с включённым `GENAI_ENABLED=1`, чтобы изображения были
  автоматически сгенерированы и загружены в Sora вместе с промптом.

Обе кнопки сохраняют актуальный файл промптов, при необходимости очищают
`submitted.log` и запускают воркер в фоне, сохраняя отзывчивость интерфейса.
